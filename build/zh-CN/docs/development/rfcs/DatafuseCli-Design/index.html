<!doctype html>
<html lang="zh-CN" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="alternate" type="application/rss+xml" href="/zh-CN/blog/rss.xml" title="Datafuse Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh-CN/blog/atom.xml" title="Datafuse Blog Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/zh-CN/weekly/rss.xml" title="Datafuse Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh-CN/weekly/atom.xml" title="Datafuse Blog Atom Feed"><title data-react-helmet="true">DatafuseCli Design | Datafuse</title><meta data-react-helmet="true" property="og:url" content="https://your-docusaurus-test-site.com/zh-CN/docs/development/rfcs/DatafuseCli-Design"><meta data-react-helmet="true" name="docusaurus_locale" content="zh-CN"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="DatafuseCli Design | Datafuse"><meta data-react-helmet="true" name="description" content="Background"><meta data-react-helmet="true" property="og:description" content="Background"><link data-react-helmet="true" rel="shortcut icon" href="/zh-CN/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://your-docusaurus-test-site.com/zh-CN/docs/development/rfcs/DatafuseCli-Design"><link data-react-helmet="true" rel="alternate" href="https://your-docusaurus-test-site.com/docs/development/rfcs/DatafuseCli-Design" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://your-docusaurus-test-site.com/zh-CN/docs/development/rfcs/DatafuseCli-Design" hreflang="zh-CN"><link data-react-helmet="true" rel="alternate" href="https://your-docusaurus-test-site.com/docs/development/rfcs/DatafuseCli-Design" hreflang="x-default"><link rel="stylesheet" href="/zh-CN/assets/css/styles.034f4e54.css">
<link rel="preload" href="/zh-CN/assets/js/runtime~main.07da80af.js" as="script">
<link rel="preload" href="/zh-CN/assets/js/main.22433080.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh-CN/"><img src="/zh-CN/img/favicon.png" alt="Datafuse Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/zh-CN/img/favicon.png" alt="Datafuse Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Datafuse</b></a><a class="navbar__item navbar__link navbar__link--active" href="/zh-CN/docs/intro">Documentation</a><a class="navbar__item navbar__link" href="/zh-CN/blog">Blog</a><a class="navbar__item navbar__link" href="/zh-CN/weekly">Weekly</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__item navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" style="vertical-align:text-bottom;margin-right:5px"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>ä¸­æ–‡ï¼ˆä¸­å›½ï¼‰</span></span></a><ul class="dropdown__menu"><li><a href="/docs/development/rfcs/DatafuseCli-Design" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">English</a></li><li><a href="/zh-CN/docs/development/rfcs/DatafuseCli-Design" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">ä¸­æ–‡ï¼ˆä¸­å›½ï¼‰</a></li></ul></div><a href="https://github.com/datafuselabs/datafuse" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/zh-CN/docs/intro">Why is Datafuse?</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">SQL Reference</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">API</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Deveplop Tutorial</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/development/development-contributing">Contribution Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/development/development-codingguidelines">Coding Guidelines</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/development/development-tracing">Tracing in Datafuse</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/development/development-howtoprofile">How to profile Datafuse</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/development/development-roadmap">Roadmap 2021</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">RFCs</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/development/rfcs/join-framework">Proposal: Join framework</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/development/rfcs/DatafuseQuery-Expression">DatafuseQuery Expression</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/development/rfcs/DatafuseQuery-Shuffle">DatafuseQuery Shuffle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/development/rfcs/datafuse-store-design">DatafuseStore Design</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/development/rfcs/Performance-Test">Performance Test</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/zh-CN/docs/development/rfcs/DatafuseCli-Design">DatafuseCli Design</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">policies</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1 class="h1Heading_27L5">Proposal: Datafuse CLI Design Doc</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="background"></a>Background<a class="hash-link" href="#background" title="Direct link to heading">#</a></h2><p><code>fusecli</code> is a command-line tool for creating, listing, logging,
deleting datafuse running instances on local or
on cloud.
It also supports to port forward webUI, monitoring dashboard on local
and run SQL query from command line</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="goals"></a>Goals<a class="hash-link" href="#goals" title="Direct link to heading">#</a></h3><ol><li>Centralized way to manage running datafuse cluster on local or on k8s(Cloud) (start, delete, update, log)</li><li>Manage and install release Instances on local machine</li><li>Show different dashboards on local (prometheus, jaeger, query web UI (like querybook or superset))</li><li>Support to run query or load data through command line</li><li>TLS Authentication support: support client side authentication, and also support to configure mTLS for managed datafuse instances</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="non-goals-for-now"></a>Non Goals for now<a class="hash-link" href="#non-goals-for-now" title="Direct link to heading">#</a></h3><ol><li>More detailed managements like manage schema, table etc</li><li>Query Task visualization (list and show all query tasks on current cluster)</li><li>RBAC tenant management(add a subcommand tenant is helpful,
and is compatible with this design)</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="installation"></a>Installation<a class="hash-link" href="#installation" title="Direct link to heading">#</a></h2><p>Use single line install script to install <code>fusecli</code> on local machine</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -fsS https://raw.githubusercontent.com/datafuselabs/datafuse/master/scripts/installer/install.sh </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">bash</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="subcommands"></a>SubCommands<a class="hash-link" href="#subcommands" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cluster-create"></a>Cluster Create<a class="hash-link" href="#cluster-create" title="Direct link to heading">#</a></h3><p>Create, Configure and switch to a datafuse cluster using the following command:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">fusecli cluster create --profile</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">datafuse profile</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Support three kinds of profile in alpha stage,</p><ol><li>local: local profile will run standalone <code>datafuse</code> cluster on local(one running fuse-query instance and one running fuse-store instance)</li><li>demo: install a standalone <code>datafuse</code> instance on cloud(k8s or maybe fargate in later stage)</li><li>cluster: install <code>datafuse</code> cluster on cloud( through <code>datafuse operator</code>)</li></ol><p>Support to use flags or yaml or toml files for deployment configuration setup
For example:</p><p>Run datafuse instance on local and setup the api address, version, tls for it</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">fusecli cluster create --profile</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">local --set local.mysql_port</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3307</span><span class="token plain"> --set local.http_address</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1:7070 --set local.version</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">v0.4.88-nightly --set local.tls_key</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">key </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> location</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">--set local.tls_cert</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">cert </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> location --set local.ca_cert</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">ca cert location</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Create and configure datafuse cluster through toml file or yaml file</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">fusecli cluster create -f cluster_configuration.toml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cluster-list"></a>Cluster List<a class="hash-link" href="#cluster-list" title="Direct link to heading">#</a></h3><p>List all clusters managed by the command line (Name with * in the cluster used in current session)</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">fusecli cluster list</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">|</span><span class="token plain"> NAME </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> PROFILE </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> CLUSTER </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> STATUS </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> ADDRESS </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> TLS </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> default</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token builtin class-name">local</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token builtin class-name">local</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> RUNNING</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> localhost:3307 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> disabled</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> demo </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> demo</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> minikube </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> RUNNING </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">172.0</span><span class="token plain">.0.11:3307 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> disabled</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> production</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> cluster </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> GKE </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> RUNNING </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">192.12</span><span class="token plain">.1.1:3307 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> enabled</span><span class="token operator" style="color:#393A34">|</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cluster-view"></a>Cluster View<a class="hash-link" href="#cluster-view" title="Direct link to heading">#</a></h3><p>View datafuse components in current cluster
For example:
In cluster profile:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">fusecli cluster view</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> NAME </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> CLUSTER </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> COMPONENT </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> STATUS </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> TLS </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> query-1 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> GKE </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> datafuse-query </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> running </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> enabled </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> query-2 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> GKE </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> datafuse-query </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> running </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> enabled </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> query-3 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> GKE </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> datafuse-query </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> pending </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> enabled </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> store-1 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> GKE </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> datafuse-store </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> running </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> enabled </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> store-2 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> GKE </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> datafuse-store </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> running </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> enabled </span><span class="token operator" style="color:#393A34">|</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Check on disk utilization</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">fusecli cluster </span><span class="token function" style="color:#d73a49">df</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> NAME </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> COMPONENT </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> USED </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> ALWAYABLE </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> LOCATION </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> local-disk-1 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Block</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 10Gi </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 90Gi </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> /mnt/fuse-store </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> s3-disk </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Object</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"> Gi </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 1000Gi </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> s3://bucket-1/mnt/fuse-store </span><span class="token operator" style="color:#393A34">|</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cluster-delete"></a>Cluster delete<a class="hash-link" href="#cluster-delete" title="Direct link to heading">#</a></h3><p>For local profile, pids in running instances shall be killed, and for cluster profile, computing pods would be deleted, can add some flags to delete disk resources as well( RBAC needed)</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">fusecli cluster delete</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cluster-log"></a>Cluster log<a class="hash-link" href="#cluster-log" title="Direct link to heading">#</a></h3><p>Show logs in current running instance</p><p>show all fuse-query logs</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">fusecli cluster log --component</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">query --all</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The command above would show all fuse-store logs</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">fusecli cluster log --component</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">store --all</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The command above would show datafuse operator logs</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">fusecli cluster log --component</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">operator</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cluster-add"></a>Cluster add<a class="hash-link" href="#cluster-add" title="Direct link to heading">#</a></h3><p>Add component to current storage</p><p>The following command add two query nodes, each need 2 cpu resource</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">fusecli cluster </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> --component query --num </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> --cpu </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> --namespace</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">operator namespace</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cluster-use"></a>Cluster use<a class="hash-link" href="#cluster-use" title="Direct link to heading">#</a></h3><p>Switch to another cluster
The Command will switch to another cluster run on GKE cloud</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">fusecli cluster use --name cloud-instance-1 --cluster GKE --kubeconfig ~/.kube/config --kubecontext gke-cloud-1</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cluster-check"></a>Cluster Check<a class="hash-link" href="#cluster-check" title="Direct link to heading">#</a></h3><p>Check whether current configuration can be deployed on given cluster</p><p>It will check on port availability, and storage resource availability for deployment</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">fusecli cluster check --profile</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">local</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>It will check on cloud resources, whether compute nodes could be scheduled on given cloud platform, whether TLS configured etc</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">fusecli cluster check -f deploy.yaml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cluster-analyze"></a>Cluster Analyze<a class="hash-link" href="#cluster-analyze" title="Direct link to heading">#</a></h3><p>Analyze and troubleshooting on given configuration, difference between analyze and check is that analyze is troubleshooting on a running cluster, and check mainly used for pre-fight check</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">fusecli cluster analyze --profile</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">local</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cluster-update"></a>Cluster Update<a class="hash-link" href="#cluster-update" title="Direct link to heading">#</a></h3><p>Update cluster to a newer version</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">fusecli cluster update v0.5.1-nightly</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="query"></a>Query<a class="hash-link" href="#query" title="Direct link to heading">#</a></h3><p>Run query using selected client</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">fusecli query </span><span class="token string" style="color:#e3116c">&#x27;SELECT * FROM TABLE1&#x27;</span><span class="token plain"> --client</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">mysql</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/development/rfcs/0005-cli-design.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/zh-CN/docs/development/rfcs/Performance-Test"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Performance Test</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/zh-CN/docs/policies/cla"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Contributor License Agreement Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#background" class="table-of-contents__link">Background</a><ul><li><a href="#goals" class="table-of-contents__link">Goals</a></li><li><a href="#non-goals-for-now" class="table-of-contents__link">Non Goals for now</a></li></ul></li><li><a href="#installation" class="table-of-contents__link">Installation</a></li><li><a href="#subcommands" class="table-of-contents__link">SubCommands</a><ul><li><a href="#cluster-create" class="table-of-contents__link">Cluster Create</a></li><li><a href="#cluster-list" class="table-of-contents__link">Cluster List</a></li><li><a href="#cluster-view" class="table-of-contents__link">Cluster View</a></li><li><a href="#cluster-delete" class="table-of-contents__link">Cluster delete</a></li><li><a href="#cluster-log" class="table-of-contents__link">Cluster log</a></li><li><a href="#cluster-add" class="table-of-contents__link">Cluster add</a></li><li><a href="#cluster-use" class="table-of-contents__link">Cluster use</a></li><li><a href="#cluster-check" class="table-of-contents__link">Cluster Check</a></li><li><a href="#cluster-analyze" class="table-of-contents__link">Cluster Analyze</a></li><li><a href="#cluster-update" class="table-of-contents__link">Cluster Update</a></li><li><a href="#query" class="table-of-contents__link">Query</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/zh-CN/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/datafuselabs/datafuse" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>weekly<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/zh-CN/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/datafuselabs/datafuse" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â©2021 Datafuse Labs. Built with Docusaurus.</div></div></div></footer></div>
<script src="/zh-CN/assets/js/runtime~main.07da80af.js"></script>
<script src="/zh-CN/assets/js/main.22433080.js"></script>
</body>
</html>